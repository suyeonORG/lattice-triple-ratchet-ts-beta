### 1.5 High-Level Summary of the Triple Ratchet

Finally, we provide a minimalistic modification of the DR, which we call the Triple Ratchet protocol, or simply TR, with virtually no overhead over the DR. This protocol is secure against the compromise scenario provided in the previous section and thus realizes our stronger ideal functionality, $\mathcal{F}_{\text {TR }}$. The TR protocol modifies the underlying public ratchet in a way that the sampled secret exponent is deterministically updated after starting a sending epoch; thus, adding a "mini ratchet" on top of Signal's public ratchet. In particular, using the notation from above, in the modified public ratchet, a party (say $\mathrm{P}_{1}$ ) after sampling secret exponent $x_{t}$, and deriving $I_{t}=\left(g^{x_{t-1}}\right)^{x_{t}}$, sends $g^{x_{t}}$ as the public ratchet message, but stores $x_{t}^{\prime}=x_{t} \cdot \mathrm{H}\left(I_{t}\right)$ instead of $x_{t}$. Once $\mathrm{P}_{2}$ receives $g^{x_{t}}$, she also derives $I_{t}$ and computes $g^{x_{t}^{\prime}}=g^{x_{t} \cdot \mathrm{H}\left(I_{t}\right)}$ that she uses for the next public ratchet. In particular, in the next epoch when $P_{2}$ becomes the sender, she samples a fresh secret exponent $x_{t+1}$, and uses the key $I_{t+1}=g^{x_{t}^{\prime} x_{t+1}} . \mathrm{P}_{2}$ sends $g^{x_{t+1}}$, upon receiving which $\mathrm{P}_{1}$ can compute $I_{t+1}$ as $\left(g^{x_{t+1}}\right)^{x_{t}^{\prime}}$, but $\mathrm{P}_{2}$ only stores $x_{t+1}^{\prime}=x_{t+1} \cdot \mathrm{H}\left(I_{t+1}\right)$, and so on. Assuming H to be a random oracle, or instead, circular-security of ElGamal encryption, we can show that given $x_{t}^{\prime}, I_{t}$ is completely hidden, rendering the attack of the previous section useless. Note that the communication cost remains the same for the modified protocol, that is one group element. The computation cost increases only slightly, specifically exactly once per epoch. We also note that, the alternate CKA scheme based on generic KEMs proposed by [3] seems to achieve this security too, albeit with doubling the communication cost.

Furthermore, as we show in Appendix F, our efficient modification can also be applied to practical UPKE schemes, reducing their communication by an additive factor of $|G|$, where $|G|$ is the number of bits needed to represent the size of the (CDH-hard) group used in the schemes. Using the modified UPKE scheme, we can reduce the communication of, e.g., the rTreeKEM scheme [4] used for Secure Group Messaging by an additive factor of $|G| \cdot n$, where $n$ is the number of users in the group.
